# awesome-malware-detection-ML


### Survey


__[Network and Computer Applications '20]__ The rise of machine learning for detection and classification of malware: Research developments, trends and challenges [[paper]](https://www.sciencedirect.com/science/article/pii/S1084804519303868) :white_check_mark:
<details><summary>Summary</summary></br>

>  * __Taxonomize ML-based malware detection approach (Survey Paper)__
>  1. Malware detection based on ML (static analysis)
>     - Employ infomration that can get without execution. 
>     - For instance, Readable string, API call (in PE Header), Permission, Binary, Control Flow Graph (CFG), etc. 
>  2. Malware detection based on ML (dynamic analysis)
>     - Examine behavior of the executable files by running them. 
>     - For instance, API call traces, Instruction traces, Memory usage, Network traffic, etc.
>  3. Malware detection based on DL (deep learning) & Multimodal
>     - Utilize different DL architecture from CNN to LSTM, GRU, so that people can replace expert knowledge required feature engineering process to simply putting raw data into model.  
>     - Investigate fusion metric with multimodal. 
>  * __Unresolved challenges (Future Research Direction)__
>     1. Class imbalance in the real-world 
>     2. Lack of public benchmark
>     3. Concept drift

</details></br>


__[EuroSys '20]__ Experiences of Landing Machine Learning onto Market-Scale Mobile Malware Detection [[paper]](https://www.cs.ucr.edu/~zhiyunq/pub/eurosys20_APIChecker.pdf)
<details><summary>Summary</summary>
- 
</details></br>


### ML-based Malware Detection & Classification (Static Analysis)



__[ACSAC '07]__ Limits of Static Analysis for Malware Detection [[paper]](https://auto.tuwien.ac.at/~chris/research/doc/acsac07_limits.pdf) - Non-ML
<details><summary>Summary</summary>
- 
</details></br>

__[Usenix ATC '13]__ MutantX-S: Scalable Malware Clustering Based on Static Features [[paper]](https://www.usenix.org/system/files/conference/atc13/atc13-hu.pdf)
<details><summary>Summary</summary>
- 
</details></br>


__[NDSS '14]__ Drebin: Effective and Explainable Detection of Android Malware in Your Pocket [[paper]](https://www.ndss-symposium.org/wp-content/uploads/2017/09/11_3_1.pdf)

<details><summary>Summary</summary>
- 
</details></br>


__[CCS '16]__ FeatureSmith: Automatically Engineering Features for Malware Detection by Mining the Security Literature [[paper]](https://dl.acm.org/doi/pdf/10.1145/2976749.2978304) :white_check_mark:

<details><summary>Summary</summary> </br>

>  * __Propose novel approach leveraging knowledge from security literature__
>  1. Motivation : Malware detection faces a significant hurdle in requiring expert-level domain knowledge for feature engineering, posing a challenge for practical deployment. Additionally, the semantic limitations of current malware detection models suggest the potential benefit of leveraging insights from professional literature to bridge these gaps.
> 
>  2. Automatic Feature Engineering (FeatureSmith)
>     * Dataset
>        * Malware: Drebin & Mobile-Sandbox
>        * Behavior: Literatures from S&P, USENIX Security, CSF, and Google scholar. 
>        * Feature (Android Document): API, Intent, and Permission
>     1. Extract behavior sentences related to malware context from the security literatures and formalize them using parser, filter, and lemmatizer. 
>     2. Construct 3-layer semantic network (malware -> extracted behavior -> feature) by assigning weighted links based on their occurence in the documents. 
>     3. Generate features by calculating ranks with probailities from the semantic network, and utilize the network inversely to provide explaination for the results.
>  * __Accumulation knowledge over time__
>  1. This study has shown that different versions of FeatureSmith built in different years accumulate the knowledge over time. As a result, the recent FeatureSmith can generate more informative and powerful features for malware detection. 
>  * __Takeaway__
>  1. This study introduce new interesting ideas that leveraging security literatures from the top conference papers.
>  2. Considered the semantic information to explain results of malware detection.  

</details></br>


__[CODASPY '17]__ DroidSieve: Fast and Accurate Classification of Obfuscated Android Malware[[paper]](https://dl.acm.org/doi/pdf/10.1145/3029806.3029825)
<details><summary>Summary</summary>
- 
</details></br>

__[ACSAC '18]__ Improving Accuracy of Android Malware Detection with Lightweight Contextual Awareness [[paper]](https://dl.acm.org/doi/pdf/10.1145/3274694.3274744)
<details><summary>Summary</summary>
- 
</details></br>


__[AAAI '19]__ Malware Detection by Eating a Whole EXE [[paper]](https://cdn.aaai.org/ocs/ws/ws0432/16422-75958-1-PB.pdf)
<details><summary>Summary</summary>
- 
</details></br>

<details><summary style="font-weight:bold">[Other Reference...]</summary>

- __[String]__ SBMDS: an interpretable string based malware detection system using SVM ensemble with bagging 
- __[ByteCode]__ Malware Detection and Classification Based on ngrams Attribute Similarity
- __[API Call]__ Malware Detection Based on Mining API Calls
- __[API Call]__ Machine Learning for Android Malware Detection Using Permission and API Calls
- __[API Call]__ Classification of Malware by Using Structural Entropy on Convolutional Neural Networks
- __[Image]__ Novel Feature Extraction, Selection and Fusion for Effective Malware Family Classification
- __[Call Graph]__ Scalable Function Call Graph-based Malware Classification
- __[Control Flow Graph]__ Mining Control Flow Graph as API Call-grams to Detect Portable Executable Malware
- __[Binary]__ Deep Neural Network Based Malware Detection Using Two Dimensional Binary Program Features
</details></br>

### ML-based Malware Detection & Classification (Dynamic & Hybrid)

__[ICSE '15]__ Deep Learning for Classification of Malware System Call Sequences [[paper]](https://link.springer.com/chapter/10.1007/978-3-319-50127-7_11)

<details><summary>Summary</summary>
- 
</details></br>

__[AISec '15]__ Better Malware Ground Truth: Techniques for Weighting Anti-Virus Vendor Labels [[paper]](https://www1.icsi.berkeley.edu/~mct/pubs/aisec15.pdf)

<details><summary>Summary</summary>
- 
</details></br>


__[AI '16]__ AppContext: Differentiating Malicious and Benign Mobile App Behaviors Using Context [[paper]](https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=7194583)

<details><summary>Summary</summary>
- 
</details></br>


__[SPW '16]__ DroidScribe: Classifying Android Malware Based on Runtime Behavior [[paper]](https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=7527777)

<details><summary>Summary</summary>
- 
</details></br>

__[DIMVA '16]__ MtNet: A Multi-Task Neural Network for Dynamic Malware Classification [[paper]](https://www.microsoft.com/en-us/research/wp-content/uploads/2016/12/HuangDimva2016.pdf)

<details><summary>Summary</summary>
- 
</details></br>



__[DIMVA '16]__ Reviewer Integration and Performance Measurement for Malware Detection [[paper]](https://www1.icsi.berkeley.edu/~mct/pubs/dimva16.pdf)

<details><summary>Summary</summary>
- 
</details></br>


__[NDSS '17]__ MaMaDroid: Detecting Android Malware by Building Markov Chains of Behavioral Models [[paper]](https://www.ndss-symposium.org/wp-content/uploads/2017/09/ndss2017_03B-3_Mariconti_paper.pdf)

<details><summary>Summary</summary>
- 
</details></br>







__[Digital Investigation '19]__ MalDy: Portable, data-driven malware detection using natural language processing and machine learning techniques on behavioral analysis reports [[paper]](https://www.sciencedirect.com/science/article/pii/S1742287619300271)
<details><summary>Summary</summary>
- 
</details></br>






__[ACSAC '19]__ Neurlux: Dynamic Malware Analysis Without Feature Engineering [[paper]](https://arxiv.org/pdf/1910.11376.pdf)
<details><summary>Summary</summary>
- 
</details></br>

<details><summary style="font-weight:bold">[Other Reference...]</summary>

- __[Instruction Trace]__ Graph-based malware detection using dynamic analysis
- __[Network Traffic]__ Unknown Malware Detection Using Network Traffic Classification
- __[Network Traffic]__ Detecting APT malware infections based on malicious DNS and traffic analysis
- __[API Call Trace]__ Behavior-based features model for malware detection
- __[API Call Trace]__ MAAR: Robust features to detect malicious activity based on API calls, their arguments and return values
- __[API Call Trace]__ Malware detection and classification based on extraction of API sequences</br>
- __[API Call Trace]__ Large-scale malware classification using random projections and neural networks
- __[API Call Trace, Network Traffic]__ MalInsight: A systematic profiling based malware detection framework
</details></br>

### Behavior Variability of Malware

__[S&P '12]__ Dissecting Android Malware: Characterization and Evolution [[paper]](https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=6234407)
<details><summary>Summary</summary>
- 
</details></br>

__[Usenix Security '21]__ When Malware Changed Its Mind: An Empirical Study of Variable Program Behaviors in the Real World [[paper]](https://www.usenix.org/system/files/sec21-avllazagaj.pdf) :white_check_mark:

<details><summary>Summary</summary></br>

>  * __Measure variability of in the wild (ITW) malware__
>  1. Collect 7.6M execution traces from 5.4M real machines (>100 countries)
>     * It contains 22K benign, 2.4K malware and 1.6K PUP samples. (labeled by AVClass & VirusTotal)
>  2. Malwares show higher variability (in terms of total actions and parameters) compared to benigns and PUPs across various machines and over time. 
>  * __Analyze invariant of ITW malware__
>  1. Analyzing malware from multiple machines brings improvement for malware detection rather than use a single machine. It makes the detector can cover more various range of malware tokens. 
>  * __Takeaway__
>  1. This measurement study demonstrate well-known variability of malwares by collecting execution traces from real hosts for long-term period.
>  2. The paper gives rise to necessitate more accurate detection model, which can consider such variability in the wild environment.

</details></br>


### Challenges for Malware Detection & Classification with ML  

__[IJCNN '17]__ Adaptive and scalable Android malware detection through online learning [[paper]](https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=7727508)
<details><summary>Summary</summary>
- 
</details></br>


__[Usenix Security '17]__ Transcend: Detecting Concept Drift in Malware Classification Models [[paper]](https://www.usenix.org/system/files/conference/usenixsecurity17/sec17-jordaney.pdf)
<details><summary>Summary</summary>
- 
</details></br>

__[Usenix Security '19]__ Improving Robustness of ML Classifiers against Realizable Evasion Attacks Using Conserved Features [[paper]](https://liang-tong.me/publication/tong2019improving/tong2019improving.pdf)
<details><summary>Summary</summary>
- 
</details></br>


__[Usenix Security '19]__ TESSERACT: Eliminating Experimental Bias in Malware Classification across Space and Time [[paper]](https://www.usenix.org/system/files/sec19fall_pendlebury_prepub.pdf)
<details><summary>Summary</summary>
- 
</details></br>


__[EuroS&P '19]__ DroidEvolver: Self-Evolving Android Malware Detection System [[paper]](https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=8806731)
<details><summary>Summary</summary>
- 
</details></br>


__[CCS '20]__ Enhancing State-of-the-art Classifiers with API Semantics to Detect Evolved Android Malware [[paper]](https://dl.acm.org/doi/pdf/10.1145/3372297.3417291)
<details><summary>Summary</summary>
- 
</details></br>


__[AISec '21]__ Investigating Labelless Drift Adaptation for Malware Detection [[paper]](https://dl.acm.org/doi/pdf/10.1145/3474369.3486873)
<details><summary>Summary</summary>
- 
</details></br>



__[NDSS '21]__ FARE: Enabling Fine-grained Attack Categorization under Low-quality Labeled Data [[paper]](https://www.ndss-symposium.org/wp-content/uploads/ndss2021_5C-4_24403_paper.pdf)
<details><summary>Summary</summary>
- 
</details></br>



__[Usenix Security '21]__ CADE: Detecting and Explaining Concept Drift Samples for Security Applications [[paper]](https://www.usenix.org/system/files/sec21-yang-limin.pdf)
<details><summary>Summary</summary>
- 
</details></br>



__[S&P '22]__ Transcending Transcend: Revisiting Malware Classification in the Presence of Concept Drift [[paper]](https://arxiv.org/pdf/2010.03856.pdf)
<details><summary>Summary</summary>
- 
</details></br>



__[TDSC '22]__ Multi-label Classification for Android Malware Based on Active Learning [[paper]](https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=9921208)
<details><summary>Summary</summary>
- 
</details></br>



__[S&P '23]__ From Grim Reality to Practical Solution: Malware Classification in Real-World Noise [[paper]](https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=10179453)
<details><summary>Summary</summary>
- 
</details></br>



__[Usenix Security '23]__  Continuous Learning for Android Malware Detection [[paper]](https://www.usenix.org/system/files/usenixsecurity23-chen-yizheng.pdf)
<details><summary>Summary</summary>
- 
</details></br>


### Worthy ML Techniques 





### Dataset & Useful Link

- __[Windows, Binary]__  Microsoft Malware Classification Challenge [[paper]](https://arxiv.org/pdf/1802.10135.pdf) [[dataset]](https://www.kaggle.com/c/malware-classification)

- __[Windows, Static]__  EMBER: An Open Dataset for Training Static PE Malware Machine Learning Models [[paper]](https://arxiv.org/pdf/1804.04637.pdf) [[dataset]](https://github.com/elastic/ember)


- __[Android, Static]__ Drebin: Effective and Explainable Detection of Android Malware in Your Pocket [[paper]](https://www.ndss-symposium.org/wp-content/uploads/2017/09/11_3_1.pdf) [[dataset]](https://drebin.mlsec.org/)

- __[Windows, Binary]__ AndroZoo: Collecting Millions of Android Apps for the Research Community [[paper]](https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=7832927) [[dataset]](https://drebin.mlsec.org/)

- https://virusshare.com/

- __[Labeling]__ https://www.virustotal.com/

- __[Labeling]__ AVCLASS: A Tool for Massive Malware Labeling [[paper]](https://software.imdea.org/~juanca/papers/avclass_raid16.pdf) 

- __[Labeling]__ AVclass2: Massive Malware Tag Extraction from AV Labels [[paper]](https://arxiv.org/pdf/2006.10615.pdf) [[code]](https://github.com/malicialab/avclass?tab=readme-ov-file)

- __[Sandbox Analysis]__ https://cuckoosandbox.org/



### Other Security Applications

__[EuroS&P '18]__  ChainSmith: Automatically Learning the Semantics of Malicious Campaigns by Mining Threat Intelligence Reports [[paper]](https://users.umiacs.umd.edu/~tdumitra/papers/EuroSP-2018.pdf)


__[AISec '21]__  INSOMNIA: Towards Concept-Drift Robustness in Network Intrusion Detection [[paper]](https://dl.acm.org/doi/pdf/10.1145/3474369.3486864)



### Evading Malware Detection

TBU


